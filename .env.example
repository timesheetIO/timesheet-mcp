# Timesheet API Configuration
# For CLI usage (Claude Desktop, direct MCP clients)
TIMESHEET_API_TOKEN=your-api-token-here
TIMESHEET_API_URL=https://api.timesheet.io

# HTTP Server Configuration
PORT=3000
HOST=0.0.0.0

# MCP Endpoint Path Configuration
# Default: /mcp (for backwards compatibility)
# Recommended for production: / (root path on dedicated subdomain like mcp.timesheet.io)
MCP_ENDPOINT_PATH=/mcp

# OAuth 2.1 Configuration (REQUIRED for ChatGPT integration)
# MCP_SERVER_URL: The public URL of this MCP server
# - Used as the 'resource' identifier in OAuth 2.1 Protected Resource Metadata
# - ChatGPT fetches /.well-known/oauth-protected-resource from this URL
# - For local development: use your ngrok URL
# - For production: use your production domain (e.g., https://mcp.timesheet.io)
MCP_SERVER_URL=https://your-ngrok-url.ngrok-free.dev

# Widget Domain Configuration (for OpenAI App widgets)
# This sets the openai/widgetDomain metadata for widget CSP
# Usually same as MCP_SERVER_URL
COMPONENT_BASE_URL=https://your-ngrok-url.ngrok-free.dev

# ngrok Configuration (for local development with ChatGPT)
# Start ngrok with: ngrok http 3000
# Then set MCP_SERVER_URL and COMPONENT_BASE_URL to the ngrok URL
NGROK_URL=https://your-ngrok-url.ngrok-free.dev

# ============================================================================
# OAuth 2.1 Flow (ChatGPT Integration)
# ============================================================================
#
# This MCP server supports OAuth 2.1 authentication for ChatGPT:
#
# 1. ChatGPT discovers auth requirements via:
#    GET {MCP_SERVER_URL}/.well-known/oauth-protected-resource
#
# 2. Response tells ChatGPT to use api.timesheet.io as authorization server:
#    {
#      "resource": "{MCP_SERVER_URL}",
#      "authorization_servers": ["https://api.timesheet.io"],
#      "bearer_methods_supported": ["header"]
#    }
#
# 3. ChatGPT performs Dynamic Client Registration (DCR):
#    POST https://api.timesheet.io/oauth2/register
#
# 4. ChatGPT initiates OAuth 2.1 Authorization Code flow with PKCE:
#    GET https://api.timesheet.io/oauth2/auth
#       ?response_type=code
#       &client_id={registered_client_id}
#       &redirect_uri=https://chatgpt.com/connector_platform_oauth_redirect
#       &code_challenge={pkce_challenge}
#       &code_challenge_method=S256
#       &resource={MCP_SERVER_URL}
#
# 5. User authenticates and authorizes on Timesheet.io
#
# 6. ChatGPT exchanges code for token:
#    POST https://api.timesheet.io/oauth2/token
#       grant_type=authorization_code
#       &code={auth_code}
#       &code_verifier={pkce_verifier}
#       &resource={MCP_SERVER_URL}
#
# 7. ChatGPT calls MCP endpoints with Bearer token:
#    POST {MCP_SERVER_URL}/mcp
#    Authorization: Bearer {access_token}
#
# ============================================================================
